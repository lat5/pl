!function(){
  "use strict";
  async function titleOrigin(card){
    var orig = card.original_title || card.original_name;
    var apiURL = "https://api.themoviedb.org/3/movie/";
    var apiKey = "&api_key=4ef0d7355d9ffb5151e987764708ce96";
    if (card.first_air_date){
      apiURL = "https://api.themoviedb.org/3/tv/";
    }
    var kp_prox = "https://worker-patient-dream-26d7.bdvburik.workers.dev/";
    var getOptions = {
      method: "GET",
      headers: {
        accept: "application/json",
      },
    };
    async function getTitle(language){
      var response = await fetch(kp_prox + apiURL + card.id + "?language=" + language + apiKey, getOptions);
      var data = await response.json();
      return data.title || data.name;
    }
    var enTitle = await getTitle("en-US");
    if (enTitle){
      $(".original_title", Lampa.Activity.active().activity.render())
        .find("> div")
        .eq(0)
        .after(
          "<div style='font-size: 1.3em; height: auto; '>En: " +
          enTitle +
          "</div><div style='font-size: 1.3em; height: auto; '> Orig: " +
          orig +
          "</div>"
        );
    }
  }
  if (!window.title_plugin){
    window.title_plugin = true;
    Lampa.Listener.follow("full", function(e){
      if (e.type == "complite"){
        var render = e.object.activity.render();
        $(".full-start-new__title", render).after('<div class="original_title" style=" margin-top:-0.8em ; text-align: right;"><div>');
        titleOrigin(e.data.movie);
        $(".full-start-new__rate-line").css("margin-bottom","0.8em");
        $(".full-start-new__details").css("margin-bottom","0.8em");
        $(".full-start-new__tagline").css("margin-bottom","0.4em");
      }
    });
  }
}();
